var VueLaravelCrud=function(t,e){"use strict";function n(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var o=n(t),i=n(e);function a(t,e,n,o,i,a,r){try{var s=t[a](r),l=s.value}catch(t){return void n(t)}s.done?e(l):Promise.resolve(l).then(o,i)}function r(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],o=!0,i=!1,a=void 0;try{for(var r,s=t[Symbol.iterator]();!(o=(r=s.next()).done)&&(n.push(r.value),!e||n.length!==e);o=!0);}catch(t){i=!0,a=t}finally{try{o||null==s.return||s.return()}finally{if(i)throw a}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return s(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return s(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var l={name:"VueLaravelCrud",components:{draggable:o.default},data:function(){return{loading:!1,items:[],displaySearch:!1,pagination:{current_page:1,last_page:1,next_page_url:"",prev_page_url:"",per_page:20,total:0},itemDefault:null,filters:[],item:{id:null},displayModes:{MODE_TABLE:1,MODE_CARDS:2}}},watch:{search:function(t){t&&""!=t?(this.filters=[],this.filters.push(["search","LIKE",t]),this.fetchItems()):(this.filters=[],this.fetchItems())}},props:{modelName:String,model:Object,title:String,columns:{type:Array,default:[{label:"Id",prop:"id",type:"number"}]},sorteable:{type:Boolean,default:!1},apiUrl:{type:String,default:"/api"},search:{type:String,default:""},showPaginator:{type:Boolean,default:!0},showHeader:{type:Boolean,default:!0},limit:{type:Number,default:20},displayMode:{type:Number,default:1},displayModeToggler:{type:Boolean,default:!1},enableDraggable:{type:Boolean,default:!1},selectHover:{type:Boolean,default:!1},selectClick:{type:Boolean,default:!1},messageRemoveConfirm:{type:String,default:"Â¿Esta seguro de borrar este elemento?"},messageRemove:{type:String,default:"BORRAR"},messageNew:{type:String,default:"Nuevo"},messageEmptyResults:{type:String,default:"No se han encontrado resultados"},messageSave:{type:String,default:"Guardar"}},mounted:function(){this.item=this.model,this.itemDefault=JSON.parse(JSON.stringify(this.item)),this.fetchItems()},computed:{filteredItems:function(){return this.items}},methods:{toggleDisplayMode:function(){this.displayMode==this.displayModes.MODE_TABLE?this.displayMode=this.displayModes.MODE_CARDS:this.displayMode==this.displayModes.MODE_CARDS&&(this.displayMode=this.displayModes.MODE_TABLE)},onRowHover:function(t,e){this.selectHover&&(this.item=this.items[e],this.onSelect())},onRowClick:function(t,e){this.selectClick&&(this.item=this.items[e],this.onSelect())},onSelect:function(){this.$emit("select",this.item)},showItem:function(t,e){this.item=this.items[e],this.onSelect(),this.$bvModal.show("modal-show-item-"+this.modelName)},createItem:function(){this.item=JSON.parse(JSON.stringify(this.itemDefault)),this.onSelect(),this.$bvModal.show("modal-form-item-"+this.modelName)},updateItem:function(t,e){this.item=this.items[e],this.onSelect(),this.$bvModal.show("modal-form-item-"+this.modelName)},refresh:function(){this.fetchItems()},fetchItems:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=this;e.loading=!0,i.default.get(this.apiUrl+"/"+this.modelName,{params:{page:t,limit:this.limit,filters:JSON.stringify(this.filters)}}).then((function(t){e.makePagination(t.data),e.items=t.data.data,e.loading=!1})).catch((function(t){e.toastError(t),e.loading=!1}))},removeItem:function(t,e){var n=this;this.$bvModal.msgBoxConfirm(messageRemoveConfirm,{size:"sm",buttonSize:"sm",okVariant:"danger",okTitle:messageRemove,cancelTitle:"NO",centered:!0}).then((function(o){o&&(n.loading=!0,i.default.delete(apiUrl+"/"+n.modelName+"/"+t).then((function(t){n.items.splice(e,1),n.loading=!1})).catch((function(t){n.toastError(t),n.loading=!1})))})).catch((function(t){n.toastError(error)}))},saveSort:function(){if(this.sorteable){var t=this;t.loading=!0;var e=[];this.items.forEach((function(t,n){e.push({id:t.id,order:n+1}),t.order=n+1})),i.default.post(this.apiUrl+"/"+t.modelName+"/sort",{order:e}).then((function(e){e.data,t.loading=!1})).catch((function(e){t.toastError(e),t.loading=!1}))}},saveItem:function(){var t,e=this;return(t=regeneratorRuntime.mark((function t(){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(n=e).loading=!0,e.item.id?i.default.put(e.apiUrl+"/"+n.modelName+"/"+n.item.id,n.item).then((function(t){n.$bvModal.hide("modal-form-item-"+n.modelName);var e=t.data,o=n.items.findIndex((function(t){return t.id==n.item.id}));n.items[o]=e,n.item=e,n.loading=!1})).catch((function(t){n.toastError(t),n.loading=!1})):i.default.post(e.apiUrl+"/"+n.modelName,n.item).then((function(t){if(n.loading=!1,n.$bvModal.hide("modal-form-item-"+n.modelName),t.data.success)t.data.message&&n.toastSuccess(t.data.message);else{var e=t.data;n.items.push(e),n.item=e}})).catch((function(t){n.toastError(t),n.loading=!1}));case 3:case"end":return t.stop()}}),t)})),function(){var e=this,n=arguments;return new Promise((function(o,i){var r=t.apply(e,n);function s(t){a(r,o,i,s,l,"next",t)}function l(t){a(r,o,i,s,l,"throw",t)}s(void 0)}))})()},toastError:function(t){this.$bvToast.toast(t.message,{title:"Error",toaster:"b-toaster-bottom-right",variant:"danger",solid:!0,appendToast:!0})},toastSuccess:function(t){this.$bvToast.toast(t,{title:"Listo",toaster:"b-toaster-bottom-right",variant:"success",solid:!0,appendToast:!0})},onPaginationChange:function(t){this.fetchItems(t)},makePagination:function(t){var e={current_page:t.current_page,last_page:t.last_page,next_page_url:t.next_page_url,prev_page_url:t.prev_page_url,total:t.total,per_page:t.per_page};this.pagination=e}}};function d(t,e,n,o,i,a,r,s,l,d){"boolean"!=typeof r&&(l=s,s=r,r=!1);const c="function"==typeof n?n.options:n;let u;if(t&&t.render&&(c.render=t.render,c.staticRenderFns=t.staticRenderFns,c._compiled=!0,i&&(c.functional=!0)),o&&(c._scopeId=o),a?(u=function(t){(t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),e&&e.call(this,l(t)),t&&t._registeredComponents&&t._registeredComponents.add(a)},c._ssrRegister=u):e&&(u=r?function(t){e.call(this,d(t,this.$root.$options.shadowRoot))}:function(t){e.call(this,s(t))}),u)if(c.functional){const t=c.render;c.render=function(e,n){return u.call(n),t(e,n)}}else{const t=c.beforeCreate;c.beforeCreate=t?[].concat(t,u):[u]}return n}const c="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());function u(t){return(t,e)=>function(t,e){const n=c?e.media||"default":t,o=p[n]||(p[n]={ids:new Set,styles:[]});if(!o.ids.has(t)){o.ids.add(t);let n=e.source;if(e.map&&(n+="\n/*# sourceURL="+e.map.sources[0]+" */",n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(e.map))))+" */"),o.element||(o.element=document.createElement("style"),o.element.type="text/css",e.media&&o.element.setAttribute("media",e.media),void 0===m&&(m=document.head||document.getElementsByTagName("head")[0]),m.appendChild(o.element)),"styleSheet"in o.element)o.styles.push(n),o.element.styleSheet.cssText=o.styles.filter(Boolean).join("\n");else{const t=o.ids.size-1,e=document.createTextNode(n),i=o.element.childNodes;i[t]&&o.element.removeChild(i[t]),i.length?o.element.insertBefore(e,i[t]):o.element.appendChild(e)}}}(t,e)}let m;const p={};var f=d({render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"crud"},[t.showHeader?n("div",{staticClass:"table-options"},[n("b-button-group",[t._t("tableActions",[n("b-button",{attrs:{variant:"success",disabled:t.loading},on:{click:function(e){return t.createItem()}}},[n("b-icon-plus"),t._v(t._s(t.messageNew)+"\n        ")],1),t._v(" "),t.displayModeToggler?n("b-button",{attrs:{variant:"info",disabled:t.loading},on:{click:function(e){return t.toggleDisplayMode()}}},[t.displayMode==t.displayModes.MODE_TABLE?n("b-icon-card-list"):t._e(),t._v(" "),t.displayMode==t.displayModes.MODE_CARDS?n("b-icon-table"):t._e()],1):t._e()],{createItem:t.createItem,toggleDisplayMode:t.toggleDisplayMode,loading:t.loading})],2),t._v(" "),n("b-input-group",[n("b-input-group-prepend",[n("b-button",{on:{click:function(e){t.displaySearch=!t.displaySearch}}},[n("b-icon-search")],1)],1),t._v(" "),t.displaySearch?n("b-form-input",{attrs:{type:"search",required:"",placeholder:"Buscar...",debounce:"500"},model:{value:t.search,callback:function(e){t.search=e},expression:"search"}}):t._e()],1)],1):t._e(),t._v(" "),n("b-overlay",{attrs:{show:t.loading,rounded:"sm"}},[t.displayMode==t.displayModes.MODE_TABLE?n("div",{staticClass:"table-responsive"},[n("table",{staticClass:"table table-hover table-striped w-100"},[n("thead",{staticClass:"thead-dark"},[n("tr",[t._t("rowHead",t._l(t.columns,(function(e,o){return n("th",{key:o},[t._v("\n                "+t._s(e.label)+"\n              ")])})))],2)]),t._v(" "),n("tbody",t._l(t.filteredItems,(function(e,o){return n("tr",{key:o,on:{mouseover:function(n){return t.onRowHover(e,o)},click:function(n){return t.onRowClick(e,o)}}},[t._t("row",t._l(t.columns,(function(i,a){return n("td",{key:a},[t._t("cell-"+i.prop,[i.prop&&i.prop.split(".").length>1&&i.prop.split(".")[1]?n("span",[t._v("\n                    "+t._s(e[i.prop.split(".")[0]][i.prop.split(".")[1]]))]):n("span",[t._v(" "+t._s(e[i.prop]))])],{item:e}),t._v(" "),"actions"==i.type?n("b-button-group",[t._t("rowAction",[n("b-button",{attrs:{variant:"primary"},on:{click:function(n){return t.showItem(e.id,o)}}},[n("b-icon-eye")],1),t._v(" "),n("b-button",{attrs:{variant:"secondary"},on:{click:function(n){return t.updateItem(e.id,o)}}},[n("b-icon-pencil")],1),t._v(" "),n("b-button",{attrs:{variant:"danger"},on:{click:function(n){return t.removeItem(e.id,o)}}},[n("b-icon-trash")],1)],{item:e,index:o,showItem:t.showItem,updateItem:t.updateItem,removeItem:t.removeItem})],2):t._e()],2)})),{item:e})],2)})),0)]),t._v(" "),0==t.items.length?n("p",{staticClass:"p-3"},[t._v("\n        "+t._s(t.messageEmptyResults)+"\n      ")]):t._e()]):t._e(),t._v(" "),t.displayMode==t.displayModes.MODE_CARDS?n("div",[0==t.items.length?n("p",{staticClass:"p-3"},[t._v("\n        "+t._s(t.messageEmptyResults)+"\n      ")]):t._e(),t._v(" "),n("draggable",{staticClass:"row",attrs:{group:"people"},on:{start:function(e){t.drag=!0},end:function(e){t.drag=!1},sort:function(e){return t.onSort()}},model:{value:t.items,callback:function(e){t.items=e},expression:"items"}},[n("b-row",t._l(t.filteredItems,(function(e,o){return n("b-col",{key:o},[n("b-card",{staticClass:"mb-2",attrs:{title:e.title,tag:"article"},scopedSlots:t._u([{key:"footer",fn:function(){return[n("b-button-group",[t._t("rowAction",[n("b-button",{attrs:{variant:"primary"},on:{click:function(n){return t.showItem(e.id,o)}}},[n("b-icon-eye")],1),t._v(" "),n("b-button",{attrs:{variant:"secondary"},on:{click:function(n){return t.updateItem(e.id,o)}}},[n("b-icon-pencil")],1),t._v(" "),n("b-button",{attrs:{variant:"danger"},on:{click:function(n){return t.removeItem(e.id,o)}}},[n("b-icon-trash")],1)],{item:e,index:o,showItem:t.showItem,updateItem:t.updateItem,removeItem:t.removeItem})],2)]},proxy:!0}],null,!0)},[t._t("row",t._l(t.columns,(function(o,i){return n("div",{key:i},["actions"!=o.type?n("b-card-text",[t._v(t._s(o.label)+":\n                    "),t._t("cell-"+o.prop,[t._v("\n                      "+t._s(e[o.prop])+"\n                    ")],{item:e})],2):t._e()],1)})),{item:e})],2)],1)})),1)],1)],1):t._e()]),t._v(" "),t.showPaginator?n("b-pagination",{attrs:{"total-rows":t.pagination.total,"per-page":t.pagination.per_page},on:{change:function(e){return t.onPaginationChange(e)}},model:{value:t.pagination.current_page,callback:function(e){t.$set(t.pagination,"current_page",e)},expression:"pagination.current_page"}}):t._e(),t._v(" "),n("b-modal",{attrs:{id:"modal-form-item-"+t.modelName,"hide-footer":"",size:"xl",title:t.title}},[n("b-overlay",{attrs:{show:t.loading,rounded:"sm"}},[t._t("form",[n("b-form-group",{attrs:{label:"Nombre:",description:"Nombre "}},[n("b-form-input",{attrs:{type:"text",required:"",placeholder:"Nombre"},model:{value:t.item.title,callback:function(e){t.$set(t.item,"title",e)},expression:"item.title"}})],1)],{item:t.item}),t._v(" "),n("b-button",{attrs:{block:"",type:"submit",variant:"success",disabled:t.loading},on:{click:function(e){return t.saveItem()}}},[t.loading?n("b-spinner",{attrs:{small:""}}):t._e(),t._v(t._s(t.messageSave)+"\n      ")],1)],2)],1),t._v(" "),n("b-modal",{attrs:{id:"modal-show-item-"+t.modelName,"hide-footer":"",size:"xl",title:t.title}},[t._t("show",[n("p",{staticClass:"my-4"},[t._v("Show")])],{item:t.item})],2)],1)},staticRenderFns:[]},(function(t){t&&t("data-v-448d29f7_0",{source:"tr td[data-v-448d29f7]:first-child,tr td[data-v-448d29f7]:last-child{width:1%;white-space:nowrap}.table-options[data-v-448d29f7]{margin-bottom:1rem}",map:void 0,media:void 0})}),l,"data-v-448d29f7",false,undefined,!1,u,void 0,void 0),h=function(){var t=f;return t.install=function(e){e.component("VueLaravelCrud",t)},t}(),g=Object.freeze({__proto__:null,default:h});return Object.entries(g).forEach((function(t){var e=r(t,2),n=e[0],o=e[1];"default"!==n&&(h[n]=o)})),h}(draggable,axios);