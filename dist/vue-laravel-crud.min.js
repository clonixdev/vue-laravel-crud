var VueLaravelCrud=function(e,t){"use strict";function a(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=a(e),i=a(t);function n(e,t,a,o,i,n,r){try{var s=e[n](r),l=s.value}catch(e){return void a(e)}s.done?t(l):Promise.resolve(l).then(o,i)}function r(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var a=[],o=!0,i=!1,n=void 0;try{for(var r,s=e[Symbol.iterator]();!(o=(r=s.next()).done)&&(a.push(r.value),!t||a.length!==t);o=!0);}catch(e){i=!0,n=e}finally{try{o||null==s.return||s.return()}finally{if(i)throw n}}return a}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return s(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return s(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,o=new Array(t);a<t;a++)o[a]=e[a];return o}var l={name:"VueLaravelCrud",components:{draggable:o.default},data:function(){return{loading:!1,items:[],displaySearch:!1,pagination:{current_page:1,last_page:1,next_page_url:"",prev_page_url:"",per_page:20,total:0},itemDefault:null,filters:[],item:{id:null},displayModes:{MODE_TABLE:1,MODE_CARDS:2}}},watch:{search:function(e){e&&""!=e?(this.filters=[],this.filters.push(["search","LIKE",e]),this.fetchItems()):(this.filters=[],this.fetchItems())}},props:{modelName:String,model:Object,title:String,columns:{type:Array,default:[{label:"Id",prop:"id",type:"number"}]},sorteable:{type:Boolean,default:!1},apiUrl:{type:String,default:"/api"},search:{type:String,default:""},showPaginator:{type:Boolean,default:!0},showHeader:{type:Boolean,default:!0},showTitle:{type:Boolean,default:!0},limit:{type:Number,default:20},displayMode:{type:Number,default:1},displayModeToggler:{type:Boolean,default:!1},colXs:{default:12,type:Number},colSm:{default:12,type:Number},colMd:{default:6,type:Number},colLg:{default:4,type:Number},colXl:{default:3,type:Number},enableDraggable:{type:Boolean,default:!1},selectHover:{type:Boolean,default:!1},selectClick:{type:Boolean,default:!1},messageRemoveConfirm:{type:String,default:"Â¿Esta seguro de borrar este elemento?"},messageRemove:{type:String,default:"BORRAR"},messageNew:{type:String,default:"Nuevo"},messageEmptyResults:{type:String,default:"No se han encontrado resultados"},messageSave:{type:String,default:"Guardar"},searchPlaceholder:{type:String,default:"Buscar..."}},mounted:function(){this.item=this.model,this.itemDefault=JSON.parse(JSON.stringify(this.item)),this.fetchItems()},computed:{filteredItems:function(){return this.items}},methods:{toggleDisplayMode:function(){this.displayMode==this.displayModes.MODE_TABLE?this.displayMode=this.displayModes.MODE_CARDS:this.displayMode==this.displayModes.MODE_CARDS&&(this.displayMode=this.displayModes.MODE_TABLE)},onRowHover:function(e,t){this.selectHover&&(this.item=this.items[t],this.onSelect())},onRowClick:function(e,t){this.selectClick&&(this.item=this.items[t],this.onSelect())},onSelect:function(){this.$emit("select",this.item)},showItem:function(e,t){this.item=this.items[t],this.onSelect(),this.$bvModal.show("modal-show-item-"+this.modelName)},createItem:function(){this.item=JSON.parse(JSON.stringify(this.itemDefault)),this.onSelect(),this.$bvModal.show("modal-form-item-"+this.modelName)},updateItem:function(e,t){this.item=this.items[t],this.onSelect(),this.$bvModal.show("modal-form-item-"+this.modelName)},refresh:function(){this.fetchItems()},fetchItems:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this;t.loading=!0,i.default.get(this.apiUrl+"/"+this.modelName,{params:{page:e,limit:this.limit,filters:JSON.stringify(this.filters)}}).then((function(e){t.makePagination(e.data),t.items=e.data.data,t.loading=!1})).catch((function(e){t.toastError(e),t.loading=!1}))},removeItem:function(e,t){var a=this;this.$bvModal.msgBoxConfirm(messageRemoveConfirm,{size:"sm",buttonSize:"sm",okVariant:"danger",okTitle:messageRemove,cancelTitle:"NO",centered:!0}).then((function(o){o&&(a.loading=!0,i.default.delete(apiUrl+"/"+a.modelName+"/"+e).then((function(e){a.items.splice(t,1),a.loading=!1})).catch((function(e){a.toastError(e),a.loading=!1})))})).catch((function(e){a.toastError(error)}))},saveSort:function(){if(this.sorteable){var e=this;e.loading=!0;var t=[];this.items.forEach((function(e,a){t.push({id:e.id,order:a+1}),e.order=a+1})),i.default.post(this.apiUrl+"/"+e.modelName+"/sort",{order:t}).then((function(t){t.data,e.loading=!1})).catch((function(t){e.toastError(t),e.loading=!1}))}},saveItem:function(){var e,t=this;return(e=regeneratorRuntime.mark((function e(){var a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(a=t).loading=!0,t.item.id?i.default.put(t.apiUrl+"/"+a.modelName+"/"+a.item.id,a.item).then((function(e){a.$bvModal.hide("modal-form-item-"+a.modelName);var t=e.data,o=a.items.findIndex((function(e){return e.id==a.item.id}));a.items[o]=t,a.item=t,a.loading=!1})).catch((function(e){a.toastError(e),a.loading=!1})):i.default.post(t.apiUrl+"/"+a.modelName,a.item).then((function(e){if(a.loading=!1,a.$bvModal.hide("modal-form-item-"+a.modelName),e.data.success)e.data.message&&a.toastSuccess(e.data.message);else{var t=e.data;a.items.push(t),a.item=t}})).catch((function(e){a.toastError(e),a.loading=!1}));case 3:case"end":return e.stop()}}),e)})),function(){var t=this,a=arguments;return new Promise((function(o,i){var r=e.apply(t,a);function s(e){n(r,o,i,s,l,"next",e)}function l(e){n(r,o,i,s,l,"throw",e)}s(void 0)}))})()},toastError:function(e){this.$bvToast.toast(e.message,{title:"Error",toaster:"b-toaster-bottom-right",variant:"danger",solid:!0,appendToast:!0})},toastSuccess:function(e){this.$bvToast.toast(e,{title:"Listo",toaster:"b-toaster-bottom-right",variant:"success",solid:!0,appendToast:!0})},onPaginationChange:function(e){this.fetchItems(e)},makePagination:function(e){var t={current_page:e.current_page,last_page:e.last_page,next_page_url:e.next_page_url,prev_page_url:e.prev_page_url,total:e.total,per_page:e.per_page};this.pagination=t}}};function d(e,t,a,o,i,n,r,s,l,d){"boolean"!=typeof r&&(l=s,s=r,r=!1);const c="function"==typeof a?a.options:a;let u;if(e&&e.render&&(c.render=e.render,c.staticRenderFns=e.staticRenderFns,c._compiled=!0,i&&(c.functional=!0)),o&&(c._scopeId=o),n?(u=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),t&&t.call(this,l(e)),e&&e._registeredComponents&&e._registeredComponents.add(n)},c._ssrRegister=u):t&&(u=r?function(e){t.call(this,d(e,this.$root.$options.shadowRoot))}:function(e){t.call(this,s(e))}),u)if(c.functional){const e=c.render;c.render=function(t,a){return u.call(a),e(t,a)}}else{const e=c.beforeCreate;c.beforeCreate=e?[].concat(e,u):[u]}return a}const c="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());function u(e){return(e,t)=>function(e,t){const a=c?t.media||"default":e,o=p[a]||(p[a]={ids:new Set,styles:[]});if(!o.ids.has(e)){o.ids.add(e);let a=t.source;if(t.map&&(a+="\n/*# sourceURL="+t.map.sources[0]+" */",a+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t.map))))+" */"),o.element||(o.element=document.createElement("style"),o.element.type="text/css",t.media&&o.element.setAttribute("media",t.media),void 0===m&&(m=document.head||document.getElementsByTagName("head")[0]),m.appendChild(o.element)),"styleSheet"in o.element)o.styles.push(a),o.element.styleSheet.cssText=o.styles.filter(Boolean).join("\n");else{const e=o.ids.size-1,t=document.createTextNode(a),i=o.element.childNodes;i[e]&&o.element.removeChild(i[e]),i.length?o.element.insertBefore(t,i[e]):o.element.appendChild(t)}}}(e,t)}let m;const p={};var f=d({render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"crud"},[e.showHeader?a("div",{staticClass:"crud-header"},[e.showTitle?a("h4",{staticClass:"crud-title"},[e._v(e._s(e.title))]):e._e(),e._v(" "),a("div",{staticClass:"table-options"},[a("b-button-group",{staticClass:"mr-1"},[e._t("tableActions",[a("b-button",{attrs:{variant:"success",disabled:e.loading},on:{click:function(t){return e.createItem()}}},[a("b-icon-plus"),e._v(e._s(e.messageNew)+"\n          ")],1),e._v(" "),e.displayModeToggler?a("b-button",{attrs:{variant:"info",disabled:e.loading},on:{click:function(t){return e.toggleDisplayMode()}}},[e.displayMode==e.displayModes.MODE_TABLE?a("b-icon-card-list"):e._e(),e._v(" "),e.displayMode==e.displayModes.MODE_CARDS?a("b-icon-table"):e._e()],1):e._e(),e._v(" "),a("div",{staticClass:"crud-search m-0"},[a("b-input-group",[a("b-input-group-prepend",[a("b-button",{class:{open:e.displaySearch},attrs:{variant:"info"},on:{click:function(t){e.displaySearch=!e.displaySearch}}},[a("b-icon-search")],1)],1),e._v(" "),e.displaySearch?a("b-form-input",{staticClass:"pl-2",attrs:{type:"search",required:"",placeholder:e.searchPlaceholder,debounce:"500"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}}):e._e()],1)],1)],{createItem:e.createItem,toggleDisplayMode:e.toggleDisplayMode,loading:e.loading})],2)],1)]):e._e(),e._v(" "),a("b-overlay",{attrs:{show:e.loading,rounded:"sm"}},[e.displayMode==e.displayModes.MODE_TABLE?a("div",{staticClass:"table-responsive"},[a("table",{staticClass:"table table-hover table-striped w-100"},[a("thead",{staticClass:"thead-light"},[a("tr",[e._t("rowHead",e._l(e.columns,(function(t,o){return a("th",{key:o},[e._v("\n                "+e._s(t.label)+"\n              ")])})))],2)]),e._v(" "),a("tbody",e._l(e.filteredItems,(function(t,o){return a("tr",{key:o,on:{mouseover:function(a){return e.onRowHover(t,o)},click:function(a){return e.onRowClick(t,o)}}},[e._t("row",e._l(e.columns,(function(i,n){return a("td",{key:n},[e._t("cell-"+i.prop,[i.prop&&i.prop.split(".").length>1&&i.prop.split(".")[1]?a("span",[e._v("\n                    "+e._s(t[i.prop.split(".")[0]][i.prop.split(".")[1]]))]):a("span",[e._v(" "+e._s(t[i.prop]))])],{item:t}),e._v(" "),"actions"==i.type?a("b-button-group",[e._t("rowAction",[a("b-button",{attrs:{variant:"primary"},on:{click:function(a){return e.showItem(t.id,o)}}},[a("b-icon-eye")],1),e._v(" "),a("b-button",{attrs:{variant:"secondary"},on:{click:function(a){return e.updateItem(t.id,o)}}},[a("b-icon-pencil")],1),e._v(" "),a("b-button",{attrs:{variant:"danger"},on:{click:function(a){return e.removeItem(t.id,o)}}},[a("b-icon-trash")],1)],{item:t,index:o,showItem:e.showItem,updateItem:e.updateItem,removeItem:e.removeItem})],2):e._e()],2)})),{item:t})],2)})),0)]),e._v(" "),0==e.items.length?a("p",{staticClass:"p-3"},[e._v("\n        "+e._s(e.messageEmptyResults)+"\n      ")]):e._e()]):e._e(),e._v(" "),e.displayMode==e.displayModes.MODE_CARDS?a("div",[0==e.items.length?a("p",{staticClass:"p-3"},[e._v("\n        "+e._s(e.messageEmptyResults)+"\n      ")]):e._e(),e._v(" "),a("draggable",{staticClass:"row",attrs:{group:"people"},on:{start:function(t){e.drag=!0},end:function(t){e.drag=!1},sort:function(t){return e.onSort()}},model:{value:e.items,callback:function(t){e.items=t},expression:"items"}},e._l(e.filteredItems,(function(t,o){return a("b-col",{key:o,attrs:{cols:e.colXs,sm:e.colSm,md:e.colMd,lg:e.colLg,xl:e.colXl}},[a("b-card",{staticClass:"mb-2",attrs:{title:t.title,tag:"article"},scopedSlots:e._u([{key:"footer",fn:function(){return[a("b-button-group",[e._t("rowAction",[a("b-button",{attrs:{variant:"primary"},on:{click:function(a){return e.showItem(t.id,o)}}},[a("b-icon-eye")],1),e._v(" "),a("b-button",{attrs:{variant:"secondary"},on:{click:function(a){return e.updateItem(t.id,o)}}},[a("b-icon-pencil")],1),e._v(" "),a("b-button",{attrs:{variant:"danger"},on:{click:function(a){return e.removeItem(t.id,o)}}},[a("b-icon-trash")],1)],{item:t,index:o,showItem:e.showItem,updateItem:e.updateItem,removeItem:e.removeItem})],2)]},proxy:!0}],null,!0)},[e._t("row",e._l(e.columns,(function(o,i){return a("div",{key:i},["actions"!=o.type?a("b-card-text",[e._v(e._s(o.label)+":\n                  "),e._t("cell-"+o.prop,[e._v("\n                    "+e._s(t[o.prop])+"\n                  ")],{item:t})],2):e._e()],1)})),{item:t})],2)],1)})),1)],1):e._e()]),e._v(" "),a("div",{staticClass:"text-center crud-paginator"},[e.showPaginator?a("b-pagination",{attrs:{"total-rows":e.pagination.total,"per-page":e.pagination.per_page},on:{change:function(t){return e.onPaginationChange(t)}},model:{value:e.pagination.current_page,callback:function(t){e.$set(e.pagination,"current_page",t)},expression:"pagination.current_page"}}):e._e()],1),e._v(" "),a("b-modal",{attrs:{id:"modal-form-item-"+e.modelName,"hide-footer":"",size:"xl",title:e.title}},[a("b-overlay",{attrs:{show:e.loading,rounded:"sm"}},[e._t("form",[a("b-form-group",{attrs:{label:"Nombre:",description:"Nombre "}},[a("b-form-input",{attrs:{type:"text",required:"",placeholder:"Nombre"},model:{value:e.item.title,callback:function(t){e.$set(e.item,"title",t)},expression:"item.title"}})],1)],{item:e.item}),e._v(" "),a("b-button",{attrs:{block:"",type:"submit",variant:"success",disabled:e.loading},on:{click:function(t){return e.saveItem()}}},[e.loading?a("b-spinner",{attrs:{small:""}}):e._e(),e._v(e._s(e.messageSave)+"\n      ")],1)],2)],1),e._v(" "),a("b-modal",{attrs:{id:"modal-show-item-"+e.modelName,"hide-footer":"",size:"xl",title:e.title}},[e._t("show",[a("p",{staticClass:"my-4"},[e._v("Show")])],{item:e.item})],2)],1)},staticRenderFns:[]},(function(e){e&&e("data-v-0b73356e_0",{source:"tr td[data-v-0b73356e]:first-child,tr td[data-v-0b73356e]:last-child{width:1%;white-space:nowrap}.crud-header[data-v-0b73356e]{display:flex;justify-content:space-between;max-height:3rem}.crud-header .crud-title[data-v-0b73356e]{margin:0}.crud-header .crud-search[data-v-0b73356e]{max-width:15rem}.crud-header .crud-search .btn[data-v-0b73356e]{border-top-left-radius:0;border-bottom-left-radius:0;border-top-right-radius:.375rem;border-bottom-right-radius:.375rem}.crud-header .crud-search .btn.open[data-v-0b73356e]{border-top-right-radius:0;border-bottom-right-radius:0}.crud-header .table-options[data-v-0b73356e]{margin-bottom:1rem;display:flex;align-items:center;justify-content:flex-end}",map:void 0,media:void 0})}),l,"data-v-0b73356e",false,undefined,!1,u,void 0,void 0),h=function(){var e=f;return e.install=function(t){t.component("VueLaravelCrud",e)},e}(),g=Object.freeze({__proto__:null,default:h});return Object.entries(g).forEach((function(e){var t=r(e,2),a=t[0],o=t[1];"default"!==a&&(h[a]=o)})),h}(draggable,axios);